<?php
require_once __DIR__ . '/includes/content.php';

header('Content-Type: application/xml; charset=utf-8');

$staticPages = [
    [
        'loc' => 'https://csskitsune.com/',
        'lastmod' => date('Y-m-d'),
        'changefreq' => 'weekly',
        'priority' => '1.0'
    ],
    [
        'loc' => 'https://csskitsune.com/blog/',
        'lastmod' => date('Y-m-d'),
        'changefreq' => 'daily',
        'priority' => '0.9'
    ],
    [
        'loc' => 'https://csskitsune.com/about.php',
        'lastmod' => date('Y-m-d'),
        'changefreq' => 'monthly',
        'priority' => '0.5'
    ]
];

$posts = get_all_posts();

echo "<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n";
echo "<urlset xmlns=\"http://www.sitemaps.org/schemas/sitemap/0.9\">\n";

foreach ($staticPages as $page) {
    echo "  <url>\n";
    echo "    <loc>{$page['loc']}</loc>\n";
    echo "    <lastmod>{$page['lastmod']}</lastmod>\n";
    echo "    <changefreq>{$page['changefreq']}</changefreq>\n";
    echo "    <priority>{$page['priority']}</priority>\n";
    echo "  </url>\n";
}

foreach ($posts as $post) {
    $loc = 'https://csskitsune.com/blog/' . $post['slug'];
    $lastmod = date('Y-m-d', $post['timestamp']);
    echo "  <url>\n";
    echo "    <loc>{$loc}</loc>\n";
    echo "    <lastmod>{$lastmod}</lastmod>\n";
    echo "    <changefreq>weekly</changefreq>\n";
    echo "    <priority>0.8</priority>\n";
    echo "  </url>\n";
}

echo "</urlset>\n";
?>